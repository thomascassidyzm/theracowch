<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>E - Exploring</title>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <style>
    
      :root {
        --ssi-primary: #0a0a0a;
        --ssi-accent: #00ff88;
        --ssi-text: #ffffff;
        --ssi-bg-secondary: #1a1a1a;
      }
      
      body {
        margin: 0;
        font-family: 'Inter', system-ui, sans-serif;
        background: var(--ssi-primary);
        color: var(--ssi-text);
      }
      
      .ssi-dashboard {
        min-height: 100vh;
        padding: 20px;
      }
      
      .version-badge {
        position: fixed;
        top: 10px;
        right: 10px;
        background: rgba(0, 0, 0, 0.8);
        padding: 5px 10px;
        border-radius: 4px;
        font-size: 12px;
        font-family: monospace;
        z-index: 9999;
      }
      
      .btn {
        background: var(--ssi-accent);
        color: var(--ssi-primary);
        border: none;
        padding: 10px 20px;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.2s ease;
      }
      
      .btn:hover {
        opacity: 0.9;
        transform: translateY(-1px);
      }
      
      .btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
      }
      
      .btn-primary {
        background: var(--ssi-accent);
      }
      
      .btn-secondary {
        background: var(--ssi-bg-secondary);
        color: var(--ssi-text);
      }
      
      .progress-bar {
        width: 100%;
        height: 8px;
        background: var(--ssi-bg-secondary);
        border-radius: 4px;
        overflow: hidden;
        margin: 10px 0;
      }
      
      .progress-fill {
        height: 100%;
        background: var(--ssi-accent);
        transition: width 0.3s ease;
      }
      
      .component-placeholder {
        background: var(--ssi-bg-secondary);
        padding: 20px;
        border-radius: 8px;
        text-align: center;
        margin: 20px 0;
      }
  </style>
</head>
<body>
  <div id="app">
    <div class="ssi-dashboard">
      <!-- Build Version Display -->
      <div class="version-badge">{{ buildVersion }}</div>
      
      <!-- Dynamic Component Routing -->
      <!-- Default Dashboard View -->
      <dashboard-home v-else />
    </div></div>
  
  <script>
    
    const { createApp, ref, reactive, computed, onMounted } = Vue;
    
    createApp({
      setup() {
        // App state
        const buildVersion = ref('1.0.0');
        const currentView = ref('dashboard-home');
        const systemStatus = reactive({
          mcpConnected: false,
          storageMode: 'local',
          activePhases: []
        });

        // Trinity compliance state
        const trinityState = reactive({
          systemToUser: {},
          userToSystem: {},
          systemToSystem: {}
        });

        
        // MCP Orchestrator integration
        const connectMCP = async () => {
          try {
            const response = await fetch('/api/mcp/connect');
            systemStatus.mcpConnected = response.ok;
            trinityState.systemToUser.mcpStatus = systemStatus.mcpConnected;
          } catch (error) {
            console.error('MCP connection failed:', error);
            trinityState.systemToUser.mcpError = error.message;
          }
        };

        // Phase execution
        const executePhase = async (phaseNumber, config) => {
          trinityState.userToSystem.phaseExecution = { phase: phaseNumber, config };
          
          try {
            const response = await fetch(`/api/phases/${phaseNumber}/execute`, {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify(config)
            });
            
            const result = await response.json();
            trinityState.systemToUser.phaseResult = result;
            systemStatus.activePhases.push(phaseNumber);
          } catch (error) {
            trinityState.systemToUser.phaseError = error.message;
          }
        };

        // Auto-resume functionality
        const autoResumePhase = async (phaseNumber) => {
          trinityState.userToSystem.autoResume = { phase: phaseNumber };
          
          try {
            const response = await fetch(`/api/auto-resume/${phaseNumber}`, {
              method: 'POST'
            });
            
            const result = await response.json();
            trinityState.systemToUser.resumeResult = result;
          } catch (error) {
            trinityState.systemToUser.resumeError = error.message;
          }
        };

        // Storage adapter switching
        const switchStorageMode = async (mode) => {
          trinityState.userToSystem.storageSwitch = { mode };
          
          try {
            systemStatus.storageMode = mode;
            trinityState.systemToUser.storageMode = mode;
          } catch (error) {
            trinityState.systemToUser.storageError = error.message;
          }
        };

        // Initialize on mount
        onMounted(async () => {
          await connectMCP();
          trinityState.systemToSystem.initialization = 'complete';
        });

        return {
          buildVersion,
          currentView,
          systemStatus,
          trinityState
        };
      },
      
      components: {
        
        'automation-launcher': {
          template: `
        <div class="automation-launcher">
          <h3>Automation Launcher</h3>
          <div class="mcp-status" :class="{ connected: mcpConnected }">
            {{ mcpConnected ? 'ðŸŸ¢ MCP Connected' : 'ðŸ”´ MCP Disconnected' }}
          </div>
          <div class="launch-controls">
            <select v-model="selectedCourse" class="course-select">
              <option v-for="course in availableCourses" :key="course.code" :value="course">
                {{ course.name }}
              </option>
            </select>
            <button @click="launchAutomation" :disabled="!canLaunch" class="btn btn-primary">
              Launch Automation
            </button>
          </div>
          <div class="automation-status" v-if="automationStatus">
            <p>{{ automationStatus.message }}</p>
          </div>
        </div>`,
          setup() {
            
        const mcpConnected = ref(false);
        const selectedCourse = ref(null);
        const availableCourses = ref([]);
        const automationStatus = ref(null);
        
        const canLaunch = computed(() => mcpConnected.value && selectedCourse.value);
        
        const launchAutomation = async () => {
          if (!canLaunch.value) return;
          
          automationStatus.value = { message: 'Launching automation...' };
          // Launch logic would be implemented here
        };
        
        return {
          mcpConnected,
          selectedCourse,
          availableCourses,
          automationStatus,
          canLaunch,
          launchAutomation
        };
          }
        },
        'progress-monitoring': {
          template: `
        <div class="progress-monitoring">
          <h3>Progress Monitoring</h3>
          <div class="monitoring-grid">
            <div v-for="monitor in activeMonitors" :key="monitor.id" class="monitor-card">
              <h4>{{ monitor.title }}</h4>
              <div class="progress-bar">
                <div class="progress-fill" :style="{ width: monitor.progress + '%' }"></div>
              </div>
              <p class="progress-text">{{ monitor.progress }}% Complete</p>
              <p class="status-text">{{ monitor.status }}</p>
            </div>
          </div>
        </div>`,
          setup() {
            
        const activeMonitors = ref([]);
        
        const addMonitor = (config) => {
          activeMonitors.value.push({
            id: Date.now(),
            title: config.title,
            progress: 0,
            status: 'Starting...'
          });
        };
        
        return {
          activeMonitors,
          addMonitor
        };
          }
        },
        'phase-execution': {
          template: `
        <div class="phase-execution-container">
          <h3>Phase Execution</h3>
          <div class="phase-controls">
            <button v-for="phase in availablePhases" 
                    :key="phase" 
                    @click="executePhase(phase)"
                    :disabled="isPhaseRunning(phase)"
                    class="btn phase-btn">
              Phase {{ phase }}
            </button>
          </div>
          <div class="phase-status" v-if="currentPhaseStatus">
            <p>{{ currentPhaseStatus.message }}</p>
            <div class="progress-bar">
              <div class="progress-fill" :style="{ width: currentPhaseStatus.progress + '%' }"></div>
            </div>
          </div>
        </div>`,
          setup() {
            
        const availablePhases = ref([1, 2, 3, 4, 5, 6, 7, 8]);
        const runningPhases = ref(new Set());
        const currentPhaseStatus = ref(null);
        
        const executePhase = async (phaseNumber) => {
          runningPhases.value.add(phaseNumber);
          currentPhaseStatus.value = { message: `Executing Phase ${phaseNumber}...`, progress: 0 };
          
          // Phase execution logic would be implemented here
          // This is a pattern template
        };
        
        const isPhaseRunning = (phase) => runningPhases.value.has(phase);
        
        return {
          availablePhases,
          executePhase,
          isPhaseRunning,
          currentPhaseStatus
        };
          }
        },
        'file-browser': {
          template: `<div class="file-browser">File Browser Component</div>`,
          setup() {
            
            const componentState = ref('initialized');
            return { componentState };
          }
        },
        'storage-adapter': {
          template: `
        <div class="storage-adapter">
          <h3>Storage Configuration</h3>
          <div class="storage-mode">
            <label>
              <input type="radio" value="local" v-model="storageMode" @change="switchStorage" />
              Local Storage
            </label>
            <label>
              <input type="radio" value="vfs" v-model="storageMode" @change="switchStorage" />
              VFS Storage
            </label>
          </div>
          <div class="storage-status">
            <p>Current Mode: {{ storageMode }}</p>
            <p>Status: {{ storageStatus }}</p>
          </div>
        </div>`,
          setup() {
            
            const componentState = ref('initialized');
            return { componentState };
          }
        },
        'auto-resume': {
          template: `
        <div class="auto-resume">
          <h3>Auto Resume</h3>
          <div class="resume-controls">
            <button @click="checkResumable" class="btn btn-secondary">
              Check Resumable
            </button>
            <button @click="autoResume" :disabled="!canResume" class="btn btn-primary">
              Auto Resume
            </button>
          </div>
          <div class="resume-status" v-if="resumeStatus">
            <p>{{ resumeStatus.message }}</p>
          </div>
        </div>`,
          setup() {
            
            const componentState = ref('initialized');
            return { componentState };
          }
        },
        'clean-pipeline': {
          template: `<div class="clean-pipeline">Clean Pipeline Component</div>`,
          setup() {
            
            const componentState = ref('initialized');
            return { componentState };
          }
        },
        'training-phase': {
          template: `<div class="training-phase">Training Phase Component</div>`,
          setup() {
            
            const componentState = ref('initialized');
            return { componentState };
          }
        },
        'dashboard-home': {
          template: `<div class="component-placeholder">
          <h2>Dashboard Home</h2>
          <p>Component generated from APML specification</p>
        </div>`,
          setup() {
            
            const componentState = ref('initialized');
            return { componentState };
          }
        }
      }
    }).mount('#app');
  </script>
</body>
</html>