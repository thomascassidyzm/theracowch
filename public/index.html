<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Theracowch - AI Therapeutic Coaching</title>
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
  <script>
    // Tailwind CSS configuration for production
    tailwind.config = {
      theme: {
        extend: {
          backdropBlur: {
            xs: '2px',
          }
        }
      }
    }
  </script>
  <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üêÑ</text></svg>">
  
  <style>
    /* Modern Hexagon Maths-inspired Design System */
    body {
      min-height: 100vh;
      background: linear-gradient(to bottom right, #1a1918, #2a2827, #1a1918);
      background-attachment: fixed;
      background-image: 
        radial-gradient(ellipse at top left, rgba(245,213,179,0.03), transparent 40%),
        radial-gradient(ellipse at bottom right, rgba(240,197,147,0.02), transparent 50%),
        linear-gradient(to bottom right, #1a1918, #2a2827, #1a1918);
      color: #f5f4f3;
      font-family: ui-sans-serif, system-ui, sans-serif;
      -webkit-font-smoothing: antialiased;
    }

    .glass {
      border: 1px solid rgba(255, 255, 255, 0.1);
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(12px);
      box-shadow: 0 25px 50px -12px rgba(147, 93, 38, 0.08), 0 10px 20px -5px rgba(0, 0, 0, 0.1);
    }

    .glass-dark {
      border: 1px solid rgba(66, 63, 60, 0.2);
      background: rgba(42, 40, 39, 0.3);
      backdrop-filter: blur(12px);
      box-shadow: 0 25px 50px -12px rgba(147, 93, 38, 0.06), 0 10px 20px -5px rgba(0, 0, 0, 0.15);
    }

    .card {
      @apply glass rounded-2xl p-6 transition-all duration-300;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.05), rgba(249, 230, 211, 0.03));
    }

    .card:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .btn-primary {
      @apply inline-flex items-center justify-center px-8 py-4 font-semibold text-white transition-all duration-500 ease-out relative overflow-hidden;
      border-radius: 2rem;
      background: linear-gradient(135deg, #6366f1, #8b5cf6, #ec4899);
      background-size: 200% 200%;
      animation: gradientShift 4s ease infinite;
      box-shadow: 
        0 12px 30px -5px rgba(99, 102, 241, 0.4), 
        0 6px 15px -3px rgba(236, 72, 153, 0.2),
        inset 0 2px 0 rgba(255, 255, 255, 0.2);
      border: 2px solid rgba(255, 255, 255, 0.15);
    }

    .btn-primary:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 
        0 25px 50px -5px rgba(99, 102, 241, 0.6), 
        0 12px 25px -3px rgba(236, 72, 153, 0.4),
        inset 0 2px 0 rgba(255, 255, 255, 0.3);
      animation-duration: 2s;
      border-color: rgba(255, 255, 255, 0.25);
    }

    .btn-primary:active {
      transform: translateY(-1px) scale(1.02);
      transition: all 0.1s ease-out;
    }

    @keyframes gradientShift {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .btn-glass {
      @apply inline-flex items-center justify-center px-8 py-4 font-semibold text-white transition-all duration-500 ease-out relative;
      border-radius: 2rem;
      border: 2px solid rgba(255, 255, 255, 0.2);
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(15px);
      box-shadow: 
        0 10px 25px -5px rgba(0, 0, 0, 0.3),
        inset 0 2px 0 rgba(255, 255, 255, 0.1);
    }

    .btn-glass:hover {
      transform: translateY(-3px) scale(1.05);
      background: rgba(255, 255, 255, 0.15);
      border-color: rgba(255, 255, 255, 0.35);
      box-shadow: 
        0 20px 40px -5px rgba(0, 0, 0, 0.4),
        inset 0 2px 0 rgba(255, 255, 255, 0.2);
    }

    .btn-glass:active {
      transform: translateY(-1px) scale(1.02);
      transition: all 0.1s ease-out;
    }

    .imagine-card {
      @apply card cursor-pointer transform transition-all duration-300 relative overflow-hidden;
      border: 1px solid rgba(255, 255, 255, 0.1);
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.08), rgba(249, 230, 211, 0.05));
    }

    .imagine-card:hover {
      transform: translateY(-6px) scale(1.03);
      border-color: rgba(255, 255, 255, 0.2);
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(249, 230, 211, 0.1));
      box-shadow: 
        0 25px 50px -12px rgba(147, 93, 38, 0.15), 
        0 15px 25px -5px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }

    .imagine-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transition: left 0.6s ease;
    }

    .imagine-card:hover::before {
      left: 100%;
    }

    .gradient-text {
      background: linear-gradient(135deg, #8590f8, #6366f1, #ec4899, #e8a968);
      background-size: 300% 300%;
      animation: gradientShift 6s ease infinite;
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .pulse-glow {
      animation: pulseGlow 3s ease-in-out infinite;
    }

    @keyframes pulseGlow {
      0%, 100% { 
        box-shadow: 0 0 20px rgba(99, 102, 241, 0.3), 0 0 40px rgba(236, 72, 153, 0.2);
      }
      50% { 
        box-shadow: 0 0 30px rgba(99, 102, 241, 0.5), 0 0 60px rgba(236, 72, 153, 0.3);
      }
    }

    .emoji-bounce {
      animation: emojiFloat 3s ease-in-out infinite;
    }

    @keyframes emojiFloat {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-10px) rotate(5deg); }
    }

    .hex-badge {
      @apply inline-flex items-center justify-center px-3 py-1 rounded-full text-xs font-medium;
      border: 1px solid rgba(99, 102, 241, 0.3);
      color: #a8b4fc;
      backdrop-filter: blur(4px);
      background: linear-gradient(135deg, rgba(133, 144, 248, 0.2), rgba(232, 169, 104, 0.1));
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .animate-fade-in-up {
      animation: fadeInUp 0.6s ease-out forwards;
    }

    .input-field {
      @apply w-full px-4 py-4 rounded-lg border text-stone-100 transition-all duration-200;
      border: 1px solid rgba(66, 63, 60, 0.3);
      background: rgba(42, 40, 39, 0.5);
      backdrop-filter: blur(4px);
      background-image: linear-gradient(to bottom right, transparent, rgba(245, 213, 179, 0.02));
    }

    .input-field::placeholder {
      color: #a59a9a;
    }

    .input-field:focus {
      border-color: rgba(99, 102, 241, 0.5);
      background: rgba(42, 40, 39, 0.7);
      box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.5);
    }
  </style>
</head>

<body>
  <div id="app">
    <!-- Main App Container -->
    <div class="min-h-screen">
      
      <!-- Navigation Header -->
      <nav class="fixed top-0 left-0 right-0 z-50 glass-dark border-b border-white/10">
        <div class="max-w-4xl mx-auto px-6 py-4">
          <div class="flex items-center justify-between">
            <div class="flex items-center space-x-3">
              <div class="w-10 h-10 rounded-2xl bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 flex items-center justify-center text-white font-bold emoji-bounce pulse-glow">
                üêÑ
              </div>
              <h1 class="text-xl font-bold gradient-text">Theracowch</h1>
            </div>
            <div class="px-4 py-2 rounded-full bg-gradient-to-r from-indigo-500/20 to-purple-500/20 border border-indigo-400/30 text-sm font-medium text-indigo-200">
              ‚ú® AI Therapeutic Coaching
            </div>
          </div>
        </div>
      </nav>

      <!-- Main Content -->
      <main class="pt-24 pb-24">
        <div class="max-w-4xl mx-auto px-6">
          
          <!-- Hero Section -->
          <div class="text-center mb-12" v-if="currentView === 'home'">
            <h1 class="text-4xl md:text-5xl font-bold mb-6 gradient-text">
              Transform Your Mental Wellness
            </h1>
            <p class="text-xl text-stone-300 mb-8 max-w-2xl mx-auto">
              Chat with AI Mandy, your personal therapeutic coach specializing in CBT and mindful living
            </p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
              <button @click="chatWithMandy" class="btn-primary group">
                <span class="emoji-bounce mr-2">üí¨</span>
                Start Coaching Session
                <svg class="w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M13.293 7.293a1 1 0 011.414 0l3 3a1 1 0 010 1.414l-3 3a1 1 0 01-1.414-1.414L14.586 12H3a1 1 0 110-2h11.586l-1.293-1.293a1 1 0 010-1.414z"/>
                </svg>
              </button>
              <button @click="exploreImagine" class="btn-glass group">
                <span class="emoji-bounce mr-2">üß†</span>
                Explore IMAGINE Framework
                <svg class="w-5 h-5 ml-2 group-hover:rotate-12 transition-transform" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"/>
                </svg>
              </button>
            </div>
          </div>

          <!-- IMAGINE Framework -->
          <div v-if="currentView === 'home' || currentView === 'imagine'">
            <div class="text-center mb-8">
              <h2 class="text-2xl font-bold mb-4 text-white">The IMAGINE Framework</h2>
              <p class="text-stone-300">Seven evidence-based domains for holistic mental wellness</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-12">
              <div v-for="(section, index) in imagineSections" 
                   :key="section.key"
                   @click="goToSection(section.key)"
                   class="imagine-card animate-fade-in-up"
                   :style="{ animationDelay: (index * 0.1) + 's' }">
                
                <div class="flex items-center space-x-4 relative z-10">
                  <div class="flex-shrink-0">
                    <div class="w-18 h-18 rounded-2xl flex items-center justify-center text-3xl shadow-lg emoji-bounce relative overflow-hidden"
                         :style="'background: ' + section.gradient + '; box-shadow: 0 12px 30px ' + section.shadowColor">
                      {{ section.emoji }}
                      <div class="absolute inset-0 bg-gradient-to-tr from-white/20 to-transparent rounded-2xl"></div>
                    </div>
                  </div>
                  <div class="flex-1">
                    <h3 class="text-lg font-semibold text-white mb-2 group-hover:text-indigo-200 transition-colors">{{ section.title }}</h3>
                    <p class="text-sm text-stone-300 group-hover:text-stone-200 transition-colors">{{ section.subtitle }}</p>
                  </div>
                  <div class="text-stone-400 group-hover:text-indigo-300 transition-all duration-300 group-hover:scale-110">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="drop-shadow-sm">
                      <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/>
                    </svg>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Chat Interface -->
          <div v-if="currentView === 'chat'" class="card max-w-2xl mx-auto">
            <div class="flex items-center justify-between mb-6">
              <div class="flex items-center space-x-3">
                <div class="w-10 h-10 rounded-full bg-gradient-to-r from-indigo-500 to-purple-500 flex items-center justify-center text-white">
                  üë©‚Äç‚öïÔ∏è
                </div>
                <div>
                  <h3 class="font-semibold text-white">AI Mandy</h3>
                  <p class="text-sm text-stone-400">Your Therapeutic Coach</p>
                </div>
              </div>
              <button @click="goHome" class="btn-glass text-sm px-4 py-2">
                ‚Üê Back
              </button>
            </div>

            <!-- Chat Messages -->
            <div class="space-y-4 mb-6 max-h-96 overflow-y-auto">
              <div v-for="message in chatHistory" :key="message.id" 
                   class="flex" :class="message.sender === 'user' ? 'justify-end' : 'justify-start'">
                <div class="max-w-xs px-4 py-3 rounded-2xl"
                     :class="message.sender === 'user' 
                       ? 'bg-gradient-to-r from-indigo-500 to-purple-500 text-white' 
                       : 'glass-dark text-stone-100'">
                  {{ message.text }}
                </div>
              </div>
              
              <div v-if="isTyping" class="flex justify-start">
                <div class="glass-dark px-4 py-3 rounded-2xl">
                  <div class="flex space-x-1">
                    <div class="w-2 h-2 bg-indigo-400 rounded-full animate-pulse"></div>
                    <div class="w-2 h-2 bg-indigo-400 rounded-full animate-pulse" style="animation-delay: 0.1s"></div>
                    <div class="w-2 h-2 bg-indigo-400 rounded-full animate-pulse" style="animation-delay: 0.2s"></div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Message Input -->
            <div class="flex space-x-3">
              <input v-model="newMessage" @keyup.enter="sendMessage" 
                     placeholder="Share what's on your mind..." 
                     class="input-field flex-1">
              <button @click="sendMessage" class="btn-primary px-6">
                Send
              </button>
            </div>
          </div>

          <!-- Mood Tracker -->
          <div v-if="currentView === 'mood'" class="card max-w-2xl mx-auto">
            <div class="text-center mb-6">
              <h2 class="text-2xl font-bold text-white mb-4">How are you feeling today?</h2>
              <p class="text-stone-300">Track your mood to identify patterns and progress</p>
            </div>
            
            <div class="grid grid-cols-5 gap-4 mb-8">
              <button v-for="mood in moodOptions" :key="mood.value"
                      @click="selectMood(mood.value)"
                      class="flex flex-col items-center p-4 rounded-xl transition-all duration-200 hover:scale-105"
                      :class="selectedMood === mood.value ? 'glass bg-indigo-500/20 border-indigo-400' : 'glass-dark hover:bg-white/10'">
                <span class="text-3xl mb-2">{{ mood.emoji }}</span>
                <span class="text-xs font-medium text-center">{{ mood.label }}</span>
              </button>
            </div>
            
            <div class="space-y-4">
              <textarea v-model="moodNote" 
                        placeholder="What's contributing to this feeling? (optional)"
                        class="input-field min-h-[100px] resize-none"></textarea>
              
              <button @click="saveMoodEntry" class="btn-primary w-full"
                      :disabled="!selectedMood">
                Save Mood Entry
              </button>
              
              <button @click="chatWithMandy" class="btn-glass w-full">
                üí¨ Talk to AI Mandy about this
              </button>
            </div>
          </div>

          <!-- Section Detail -->
          <div v-if="currentView === 'section' && currentSection" class="card max-w-2xl mx-auto">
            <div class="flex items-center justify-between mb-6">
              <div class="flex items-center space-x-3">
                <div class="w-12 h-12 rounded-2xl flex items-center justify-center text-xl"
                     :style="'background: ' + currentSection.gradient">
                  {{ currentSection.emoji }}
                </div>
                <div>
                  <h2 class="text-xl font-bold text-white">{{ currentSection.title }}</h2>
                  <p class="text-stone-300">{{ currentSection.subtitle }}</p>
                </div>
              </div>
              <button @click="goHome" class="btn-glass text-sm px-4 py-2">
                ‚Üê Back
              </button>
            </div>

            <div class="space-y-6">
              <div class="glass-dark p-4 rounded-xl">
                <h3 class="font-semibold text-white mb-2">Guidance</h3>
                <p class="text-stone-300">{{ getSectionGuidance(currentSection.key) }}</p>
              </div>

              <div class="grid grid-cols-1 gap-4">
                <div v-for="tool in getSectionTools(currentSection.key)" :key="tool.id"
                     class="glass-dark p-4 rounded-xl cursor-pointer hover:bg-white/10 transition-all">
                  <div class="flex items-center space-x-3">
                    <span class="text-xl">{{ tool.icon }}</span>
                    <div>
                      <h4 class="font-medium text-white">{{ tool.name }}</h4>
                      <p class="text-sm text-stone-400">{{ tool.description }}</p>
                    </div>
                  </div>
                </div>
              </div>

              <button @click="chatWithMandy" class="btn-primary w-full">
                üí¨ Discuss This with AI Mandy
              </button>
            </div>
          </div>

        </div>
      </main>

      <!-- Bottom Navigation -->
      <nav class="fixed bottom-0 left-0 right-0 z-50 glass-dark border-t border-white/10 backdrop-blur-xl">
        <div class="max-w-4xl mx-auto px-4 py-3">
          <div class="flex justify-around items-center">
            <button @click="goHome" class="flex flex-col items-center space-y-1 p-3 rounded-xl transition-all duration-300 relative group"
                    :class="currentView === 'home' ? 'text-indigo-400 bg-indigo-500/20 shadow-lg' : 'text-stone-400 hover:text-white hover:bg-white/10'">
              <div class="relative">
                <svg class="w-6 h-6 transition-transform group-hover:scale-110" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                </svg>
                <div v-if="currentView === 'home'" class="absolute -top-1 -right-1 w-2 h-2 bg-indigo-400 rounded-full pulse-glow"></div>
              </div>
              <span class="text-xs font-medium">üè† Home</span>
            </button>
            
            <button @click="chatWithMandy" class="flex flex-col items-center space-y-1 p-3 rounded-xl transition-all duration-300 relative group"
                    :class="currentView === 'chat' ? 'text-purple-400 bg-purple-500/20 shadow-lg' : 'text-stone-400 hover:text-white hover:bg-white/10'">
              <div class="relative">
                <svg class="w-6 h-6 transition-transform group-hover:scale-110" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M20 2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h4l4 4 4-4h4c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/>
                </svg>
                <div v-if="currentView === 'chat'" class="absolute -top-1 -right-1 w-2 h-2 bg-purple-400 rounded-full pulse-glow"></div>
              </div>
              <span class="text-xs font-medium">üí¨ Chat</span>
            </button>
            
            <button @click="exploreImagine" class="flex flex-col items-center space-y-1 p-3 rounded-xl transition-all duration-300 relative group"
                    :class="currentView === 'imagine' ? 'text-pink-400 bg-pink-500/20 shadow-lg' : 'text-stone-400 hover:text-white hover:bg-white/10'">
              <div class="relative">
                <svg class="w-6 h-6 transition-transform group-hover:scale-110" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                </svg>
                <div v-if="currentView === 'imagine'" class="absolute -top-1 -right-1 w-2 h-2 bg-pink-400 rounded-full pulse-glow"></div>
              </div>
              <span class="text-xs font-medium">üß† IMAGINE</span>
            </button>
            
            <button @click="showMoodTracker" class="flex flex-col items-center space-y-1 p-3 rounded-xl transition-all duration-300 relative group"
                    :class="currentView === 'mood' ? 'text-emerald-400 bg-emerald-500/20 shadow-lg' : 'text-stone-400 hover:text-white hover:bg-white/10'">
              <div class="relative">
                <svg class="w-6 h-6 transition-transform group-hover:scale-110" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M9 11H7v8h2v-8zm4-4h-2v12h2V7zm4-4h-2v16h2V3z"/>
                </svg>
                <div v-if="currentView === 'mood'" class="absolute -top-1 -right-1 w-2 h-2 bg-emerald-400 rounded-full pulse-glow"></div>
              </div>
              <span class="text-xs font-medium">üìà Progress</span>
            </button>
          </div>
        </div>
      </nav>
    </div>
  </div>

  <script>
    const { createApp, ref } = Vue;
    
    createApp({
      setup() {
        const currentView = ref('home');
        const currentSection = ref(null);
        const newMessage = ref('');
        const isTyping = ref(false);
        const selectedMood = ref(null);
        const moodNote = ref('');
        
        const moodOptions = ref([
          { value: 1, emoji: 'üò¢', label: 'Very Low' },
          { value: 2, emoji: 'üòî', label: 'Low' },
          { value: 3, emoji: 'üòê', label: 'Neutral' },
          { value: 4, emoji: 'üôÇ', label: 'Good' },
          { value: 5, emoji: 'üòä', label: 'Great' }
        ]);
        
        const imagineSections = ref([
          {
            key: 'self_care',
            title: 'I - Me, Myself & I',
            subtitle: 'Self-care and personal wellness',
            emoji: 'üíé',
            gradient: 'linear-gradient(135deg, #d4a574 0%, #8b6914 100%)', // warm_earth_tones
            shadowColor: 'rgba(212, 165, 116, 0.4)'
          },
          {
            key: 'mindfulness',
            title: 'M - Mindfulness',
            subtitle: 'Present moment awareness',
            emoji: 'üßò',
            gradient: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)', // calm_blues_greens
            shadowColor: 'rgba(79, 172, 254, 0.4)'
          },
          {
            key: 'acceptance',
            title: 'A - Acceptance',
            subtitle: 'Embracing your current state',
            emoji: 'ü§ó',
            gradient: 'linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)', // soft_pastels
            shadowColor: 'rgba(168, 237, 234, 0.4)'
          },
          {
            key: 'gratitude',
            title: 'G - Gratitude',
            subtitle: 'Focusing on positive aspects',
            emoji: 'üôè',
            gradient: 'linear-gradient(135deg, #fee140 0%, #fa709a 100%)', // warm_yellows_oranges
            shadowColor: 'rgba(254, 225, 64, 0.4)'
          },
          {
            key: 'interactions',
            title: 'I - Interactions',
            subtitle: 'Connecting with others',
            emoji: 'üí¨',
            gradient: 'linear-gradient(135deg, #a855f7 0%, #ec4899 100%)', // friendly_purples_pinks
            shadowColor: 'rgba(168, 85, 247, 0.4)'
          },
          {
            key: 'nurturing',
            title: 'N - Nurturing',
            subtitle: 'Fun, playfulness, and joy',
            emoji: 'üå±',
            gradient: 'linear-gradient(135deg, #34d399 0%, #fbbf24 100%)', // bright_cheerful_colors
            shadowColor: 'rgba(52, 211, 153, 0.4)'
          },
          {
            key: 'exploring',
            title: 'E - Exploring',
            subtitle: 'Understanding thoughts & behaviors',
            emoji: 'üîç',
            gradient: 'linear-gradient(135deg, #10b981 0%, #3b82f6 100%)', // discovery_greens_blues
            shadowColor: 'rgba(16, 185, 129, 0.4)'
          }
        ]);

        const chatHistory = ref([
          {
            id: 1,
            sender: 'ai_mandy',
            text: "Hello! I'm AI Mandy, your therapeutic coach. I'm here to support you on your wellness journey. What's on your mind today?",
            timestamp: new Date()
          }
        ]);

        const chatWithMandy = () => {
          currentView.value = 'chat';
        };

        const exploreImagine = () => {
          currentView.value = 'imagine';
        };

        const showMoodTracker = () => {
          currentView.value = 'mood';
        };

        const goHome = () => {
          currentView.value = 'home';
        };

        const goToSection = (sectionKey) => {
          const section = imagineSections.value.find(s => s.key === sectionKey);
          if (section) {
            currentSection.value = section;
            currentView.value = 'section';
          }
        };

        const getSectionGuidance = (sectionKey) => {
          const guidance = {
            self_care: "Your relationship with yourself sets the foundation for everything else. What would loving yourself look like today?",
            mindfulness: "This moment is the only one where change can happen. What do you notice right now, without judgment?",
            acceptance: "Fighting what is only creates more suffering. What would accepting this situation allow you to do?",
            gratitude: "Gratitude shifts perspective from lack to abundance. What's working in your life right now?",
            interactions: "Connection is essential for wellbeing. How might you nurture your relationships today?",
            nurturing: "Joy and playfulness are not luxuries‚Äîthey're necessities. What brings lightness to your heart?",
            exploring: "Understanding your patterns is the first step to change. What thoughts or behaviors are you curious about?"
          };
          return guidance[sectionKey] || "Welcome to this section of your wellness journey.";
        };

        const getSectionTools = (sectionKey) => {
          const tools = {
            self_care: [
              { id: 1, name: "Wellness Check-In", description: "Assess your current needs", icon: "üåü" },
              { id: 2, name: "Boundary Setting", description: "Practice saying no with kindness", icon: "üõ°Ô∏è" },
              { id: 3, name: "Energy Audit", description: "Identify what drains and energizes you", icon: "‚ö°" }
            ],
            mindfulness: [
              { id: 1, name: "5-4-3-2-1 Grounding", description: "Connect with your senses", icon: "üåø" },
              { id: 2, name: "Breath Awareness", description: "Simple breathing exercises", icon: "üí®" },
              { id: 3, name: "Body Scan", description: "Check in with physical sensations", icon: "üßò" }
            ],
            acceptance: [
              { id: 1, name: "What I Can/Can't Control", description: "Clarify your sphere of influence", icon: "üéØ" },
              { id: 2, name: "Self-Compassion Practice", description: "Treat yourself with kindness", icon: "üíù" },
              { id: 3, name: "Radical Acceptance", description: "Practice accepting difficult emotions", icon: "ü§≤" }
            ],
            gratitude: [
              { id: 1, name: "Three Good Things", description: "Daily appreciation practice", icon: "‚ú®" },
              { id: 2, name: "Gratitude Letter", description: "Write to someone who helped you", icon: "üíå" },
              { id: 3, name: "Small Wins", description: "Celebrate minor victories", icon: "üèÜ" }
            ],
            interactions: [
              { id: 1, name: "Connection Inventory", description: "Review your relationships", icon: "üë•" },
              { id: 2, name: "Active Listening", description: "Practice deep listening skills", icon: "üëÇ" },
              { id: 3, name: "Difficult Conversations", description: "Scripts for challenging talks", icon: "üí¨" }
            ],
            nurturing: [
              { id: 1, name: "Play Break", description: "Do something just for fun", icon: "üé≠" },
              { id: 2, name: "Creative Expression", description: "Art, music, or writing", icon: "üé®" },
              { id: 3, name: "Inner Child", description: "Connect with your playful side", icon: "üß∏" }
            ],
            exploring: [
              { id: 1, name: "Thought Record", description: "Track your thinking patterns", icon: "üìù" },
              { id: 2, name: "Trigger Mapping", description: "Identify what sets off reactions", icon: "üó∫Ô∏è" },
              { id: 3, name: "Values Clarification", description: "Understand what matters most", icon: "üß≠" }
            ]
          };
          return tools[sectionKey] || [];
        };

        const sendMessage = async () => {
          if (!newMessage.value.trim()) return;
          
          const userMessageText = newMessage.value;
          
          chatHistory.value.push({
            id: Date.now(),
            sender: 'user',
            text: userMessageText,
            timestamp: new Date()
          });

          newMessage.value = '';
          isTyping.value = true;

          // Call the real API with better error handling
          try {
            const response = await fetch('/api/chat', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify({
                message: userMessageText,
                conversationHistory: chatHistory.value.slice(-6),
                currentPattern: 'general',
                sessionPhase: 'exploring'
              })
            });

            const data = await response.json();
            console.log('API Response:', response.status, data);

            if (response.ok && data.response) {
              chatHistory.value.push({
                id: Date.now() + 1,
                sender: 'ai_mandy',
                text: data.response,
                timestamp: new Date()
              });
            } else if (data.fallback) {
              // Use the API's fallback response
              chatHistory.value.push({
                id: Date.now() + 1,
                sender: 'ai_mandy',
                text: data.fallback,
                timestamp: new Date()
              });
            } else {
              throw new Error(`API error: ${response.status}`);
            }
          } catch (error) {
            console.error('Chat API Error:', error);
            chatHistory.value.push({
              id: Date.now() + 1,
              sender: 'ai_mandy',
              text: "I'm having a brief technical moment, but I'm here with you. Sometimes we all need to pause and regroup. What's one thing you're feeling right now?",
              timestamp: new Date()
            });
          }

          isTyping.value = false;
        };

        const selectMood = (value) => {
          selectedMood.value = value;
        };

        const saveMoodEntry = () => {
          if (!selectedMood.value) return;
          
          // Here you could save to localStorage or send to an API
          console.log('Saving mood entry:', {
            mood: selectedMood.value,
            note: moodNote.value,
            timestamp: new Date()
          });
          
          // Reset and show success
          selectedMood.value = null;
          moodNote.value = '';
          
          // Show a simple success message
          chatHistory.value.push({
            id: Date.now(),
            sender: 'system',
            text: 'Mood entry saved! Tracking your emotional patterns helps identify what supports your wellbeing.',
            timestamp: new Date()
          });
          
          // Switch to chat view
          currentView.value = 'chat';
        };

        return {
          currentView,
          currentSection,
          newMessage,
          isTyping,
          selectedMood,
          moodNote,
          moodOptions,
          imagineSections,
          chatHistory,
          chatWithMandy,
          exploreImagine,
          showMoodTracker,
          goHome,
          goToSection,
          getSectionGuidance,
          getSectionTools,
          sendMessage,
          selectMood,
          saveMoodEntry
        };
      }
    }).mount('#app');
  </script>
</body>
</html>